<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Create Account | Ullr Systems</title>
  
  <!-- Link to your CSS file -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <!-- Top navbar / banner -->
  <header>
    <h1 class="brand">
      Ullr <span>Systems</span>
    </h1>
  </header>

  <!-- Main content wrapper -->
  <main class="form-container">
    
    <h2>Create Account</h2>
    
    <!-- Same form ID and action as existing code -->
    <form id="SignUpForm" method="POST" action="createUser" class="create-form">
      <!-- Label for screen readers only -->
      <label for="userData" class="sr-only">Enter Username and Select role to create an account</label>
      
      <!-- Username field -->
      <div class="form-group">
        <label for="username" class="sr-only">Username</label>
        <input
          type="text"
          id="username"
          name="username"
          placeholder="Enter your username here"
          required
        />
      </div>
      
      <!-- Role dropdown -->
      <div class="form-group">
        <label for="role" class="sr-only">Select Role</label>
        <select id="role" name="role" required>
          <option value="1">Delivery Driver</option>
          <option value="2">Head Chef</option>
          <option value="3">Admin</option>
          <!-- Add/edit roles if needed, but keep the numeric values your code expects -->
        </select>
      </div>
      
      <!-- Submit button -->
      <button type="submit" class="btn-submit">Submit</button>
    </form>
    
    <!-- Popup / password script container -->
    <div id="passwordPopup">
      <script>
        function showPassword(password) {
          alert("New user's generated password is: " + password);
        }
        
        document.getElementById("SignUpForm").addEventListener("submit", async function (event) {
          event.preventDefault();
          const formData = new FormData(document.getElementById("SignUpForm"));
          try {
            const response = await fetch('/UllrSystems/createUser', {
              method: 'POST',
              body: formData
            });
            if (!response.ok) {
              throw new Error("Failed to submit the form.");
            }
            const data = await response.json();
            if (data.success) {
              showPassword(data.password);
            } else {
              alert("Username already in use. Please try again with a different username.");
            }
          } catch (error) {
            console.error("Error:", error);
            alert("Username already in use. Please try again with a different username.");
          }
        });
      </script>
    </div>
    
  </main>
  
</body>
</html>
